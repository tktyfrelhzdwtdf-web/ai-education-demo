<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚öôÔ∏è –°–∏–º—É–ª—è—Ç–æ—Ä —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–∏–ø—É—Å–∫–æ–≤ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .simulator {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }
        .subtitle {
            font-size: 18px;
            opacity: 0.9;
        }
        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }
        .controls {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #3498db;
        }
        .visualization {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #e74c3c;
            position: relative;
        }
        .param-group {
            margin-bottom: 25px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #2c3e50;
            font-size: 16px;
        }
        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }
        .slider {
            flex: 1;
            height: 8px;
            -webkit-appearance: none;
            background: #ddd;
            border-radius: 4px;
            outline: none;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: #3498db;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .value-display {
            min-width: 80px;
            font-weight: bold;
            color: #2c3e50;
            text-align: center;
            background: #e8f4fc;
            padding: 5px 10px;
            border-radius: 20px;
        }
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #3498db;
            border-radius: 8px;
            font-size: 16px;
            background: white;
            cursor: pointer;
        }
        .result {
            background: #2c3e50;
            color: white;
            padding: 30px;
            text-align: center;
        }
        .calculation-result {
            font-size: 24px;
            font-weight: bold;
            margin: 15px 0;
            color: #27ae60;
        }
        .details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        .detail-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        .detail-value {
            font-size: 20px;
            font-weight: bold;
            color: #3498db;
            margin: 5px 0;
        }
        .workpiece {
            width: 300px;
            height: 200px;
            margin: 0 auto;
            position: relative;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
        }
        .material-layer {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            border: 2px dashed;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        .rough-layer {
            background: rgba(231, 76, 60, 0.1);
            border-color: #e74c3c;
        }
        .finish-layer {
            background: rgba(52, 152, 219, 0.1);
            border-color: #3498db;
        }
        .final-part {
            background: rgba(46, 204, 113, 0.2);
            border: 2px solid #2ecc71;
        }
        .dimension-line {
            position: absolute;
            background: #2c3e50;
            font-size: 12px;
            color: #2c3e50;
            font-weight: bold;
        }
        .dimension-line.horizontal {
            width: 2px;
            height: 30px;
        }
        .dimension-line.vertical {
            width: 30px;
            height: 2px;
        }
        .dimension-label {
            position: absolute;
            background: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
            border: 1px solid #bdc3c7;
        }
        .funny-comment {
            font-size: 18px;
            margin: 15px 0;
            font-style: italic;
            color: #f39c12;
        }
        .emoji {
            font-size: 24px;
            margin: 0 5px;
        }
        .recommendations {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #ffc107;
        }
        .recommendations h3 {
            color: #856404;
            margin-bottom: 10px;
        }
        .recommendations ul {
            list-style: none;
            padding: 0;
        }
        .recommendations li {
            padding: 5px 0;
            color: #856404;
        }
        @media (max-width: 768px) {
            .content {
                grid-template-columns: 1fr;
            }
            .details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="simulator">
        <div class="header">
            <h1>‚öôÔ∏è –°–ò–ú–£–õ–Ø–¢–û–† –†–ê–°–ß–ï–¢–ê –ü–†–ò–ü–£–°–ö–û–í –ù–ê –û–ë–†–ê–ë–û–¢–ö–£</h1>
            <div class="subtitle">–†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–ø—É—Å–∫–∏ –¥–ª—è —Ç–æ–∫–∞—Ä–Ω–æ–π –∏ —Ñ—Ä–µ–∑–µ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏</div>
        </div>
        
        <div class="content">
            <div class="controls">
                <div class="param-group">
                    <label>üìè –ò—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∑–∞–≥–æ—Ç–æ–≤–∫–∏: <span id="initialSizeValue" class="value-display">100 –º–º</span></label>
                    <div class="slider-container">
                        <span>50 –º–º</span>
                        <input type="range" min="50" max="500" value="100" class="slider" id="initialSizeSlider">
                        <span>500 –º–º</span>
                    </div>
                </div>

                <div class="param-group">
                    <label>üéØ –ö–æ–Ω–µ—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–µ—Ç–∞–ª–∏: <span id="finalSizeValue" class="value-display">187 –º–º</span></label>
                    <div class="slider-container">
                        <span>40 –º–º</span>
                        <input type="range" min="40" max="450" value="187" class="slider" id="finalSizeSlider">
                        <span>450 –º–º</span>
                    </div>
                </div>

                <div class="param-group">
                    <label>üîß –ú–∞—Ç–µ—Ä–∏–∞–ª –∑–∞–≥–æ—Ç–æ–≤–∫–∏:</label>
                    <select id="materialSelect">
                        <option value="steel">–°—Ç–∞–ª—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–æ–Ω–Ω–∞—è</option>
                        <option value="stainless">–ù–µ—Ä–∂–∞–≤–µ—é—â–∞—è —Å—Ç–∞–ª—å</option>
                        <option value="aluminum">–ê–ª—é–º–∏–Ω–∏–π –∏ —Å–ø–ª–∞–≤—ã</option>
                        <option value="copper">–ú–µ–¥—å –∏ –±—Ä–æ–Ω–∑–∞</option>
                        <option value="castiron">–ß—É–≥—É–Ω</option>
                        <option value="titanium">–¢–∏—Ç–∞–Ω–æ–≤—ã–µ —Å–ø–ª–∞–≤—ã</option>
                    </select>
                </div>

                <div class="param-group">
                    <label>‚ö° –¢–∏–ø –æ–±—Ä–∞–±–æ—Ç–∫–∏:</label>
                    <select id="processSelect">
                        <option value="turning">–¢–æ–∫–∞—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</option>
                        <option value="milling">–§—Ä–µ–∑–µ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</option>
                        <option value="grinding">–®–ª–∏—Ñ–æ–≤–∞–Ω–∏–µ</option>
                        <option value="drilling">–°–≤–µ—Ä–ª–µ–Ω–∏–µ/—Ä–∞—Å—Ç–∞—á–∏–≤–∞–Ω–∏–µ</option>
                    </select>
                </div>

                <div class="param-group">
                    <label>üìä –ö–≤–∞–ª–∏—Ç–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏:</label>
                    <select id="toleranceSelect">
                        <option value="it7">IT7 (–≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å)</option>
                        <option value="it8">IT8</option>
                        <option value="it9">IT9</option>
                        <option value="it10">IT10 (—Å—Ä–µ–¥–Ω—è—è —Ç–æ—á–Ω–æ—Å—Ç—å)</option>
                        <option value="it11">IT11</option>
                        <option value="it12">IT12 (–≥—Ä—É–±–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)</option>
                    </select>
                </div>

                <div class="param-group">
                    <label>üîÑ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤: <span id="passesValue" class="value-display">2</span></label>
                    <div class="slider-container">
                        <span>1</span>
                        <input type="range" min="1" max="5" value="2" class="slider" id="passesSlider">
                        <span>5</span>
                    </div>
                </div>
            </div>

            <div class="visualization">
                <h3>üëÅÔ∏è –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò–ü–£–°–ö–û–í</h3>
                <div class="workpiece" id="workpiece">
                    <!-- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è JavaScript -->
                </div>
                <div class="funny-comment" id="funnyComment">
                    –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–∏–ø—É—Å–∫–æ–≤! üîß
                </div>
                
                <div class="recommendations">
                    <h3>üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò</h3>
                    <ul id="recommendationsList">
                        <li>‚Ä¢ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–∞–∑–º–µ—Ä—ã –∑–∞–≥–æ—Ç–æ–≤–∫–∏ –∏ –¥–µ—Ç–∞–ª–∏</li>
                        <li>‚Ä¢ –í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª –∏ —Ç–∏–ø –æ–±—Ä–∞–±–æ—Ç–∫–∏</li>
                        <li>‚Ä¢ –°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—Å—á–∏—Ç–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–ø—É—Å–∫–∏</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="result">
            <h2>üìà –†–ï–ó–£–õ–¨–¢–ê–¢–´ –†–ê–°–ß–ï–¢–ê</h2>
            <div class="calculation-result" id="totalAllowance">
                –û–±—â–∏–π –ø—Ä–∏–ø—É—Å–∫: -- –º–º
            </div>
            <div class="details">
                <div class="detail-item">
                    <div>–ù–∞ —Å—Ç–æ—Ä–æ–Ω—É</div>
                    <div class="detail-value" id="perSideAllowance">-- –º–º</div>
                    <div>üìè</div>
                </div>
                <div class="detail-item">
                    <div>–ß–µ—Ä–Ω–æ–≤–æ–π –ø—Ä–∏–ø—É—Å–∫</div>
                    <div class="detail-value" id="roughAllowance">-- –º–º</div>
                    <div>‚ö°</div>
                </div>
                <div class="detail-item">
                    <div>–ß–∏—Å—Ç–æ–≤–æ–π –ø—Ä–∏–ø—É—Å–∫</div>
                    <div class="detail-value" id="finishAllowance">-- –º–º</div>
                    <div>üéØ</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø—Ä–∏–ø—É—Å–∫–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
        const allowanceCoefficients = {
            steel: { turning: 1.2, milling: 1.4, grinding: 0.3, drilling: 1.1 },
            stainless: { turning: 1.3, milling: 1.5, grinding: 0.4, drilling: 1.2 },
            aluminum: { turning: 1.1, milling: 1.3, grinding: 0.2, drilling: 1.0 },
            copper: { turning: 1.0, milling: 1.2, grinding: 0.2, drilling: 0.9 },
            castiron: { turning: 1.4, milling: 1.6, grinding: 0.5, drilling: 1.3 },
            titanium: { turning: 1.5, milling: 1.7, grinding: 0.6, drilling: 1.4 }
        };

        // –¢–æ—á–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ –∫–≤–∞–ª–∏—Ç–µ—Ç–∞–º (–º–º)
        const toleranceValues = {
            it7: 0.03, it8: 0.05, it9: 0.08, it10: 0.12, it11: 0.20, it12: 0.35
        };

        // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã DOM
        const initialSizeSlider = document.getElementById('initialSizeSlider');
        const finalSizeSlider = document.getElementById('finalSizeSlider');
        const passesSlider = document.getElementById('passesSlider');
        const materialSelect = document.getElementById('materialSelect');
        const processSelect = document.getElementById('processSelect');
        const toleranceSelect = document.getElementById('toleranceSelect');

        const initialSizeValue = document.getElementById('initialSizeValue');
        const finalSizeValue = document.getElementById('finalSizeValue');
        const passesValue = document.getElementById('passesValue');

        const totalAllowance = document.getElementById('totalAllowance');
        const perSideAllowance = document.getElementById('perSideAllowance');
        const roughAllowance = document.getElementById('roughAllowance');
        const finishAllowance = document.getElementById('finishAllowance');
        const funnyComment = document.getElementById('funnyComment');
        const recommendationsList = document.getElementById('recommendationsList');
        const workpiece = document.getElementById('workpiece');

        // –§—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–∏–ø—É—Å–∫–æ–≤
        function calculateAllowances() {
            const initialSize = parseFloat(initialSizeSlider.value);
            const finalSize = parseFloat(finalSizeSlider.value);
            const passes = parseInt(passesSlider.value);
            const material = materialSelect.value;
            const process = processSelect.value;
            const tolerance = toleranceSelect.value;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞–∑–º–µ—Ä–æ–≤
            if (finalSize > initialSize) {
                funnyComment.innerHTML = `–û—à–∏–±–∫–∞! <span class="emoji">‚ö†Ô∏è</span> –ö–æ–Ω–µ—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ!`;
                totalAllowance.textContent = `–û–±—â–∏–π –ø—Ä–∏–ø—É—Å–∫: -- –º–º`;
                perSideAllowance.textContent = `-- –º–º`;
                roughAllowance.textContent = `-- –º–º`;
                finishAllowance.textContent = `-- –º–º`;
                recommendationsList.innerHTML = `
                    <li>‚Ä¢ –ö–æ–Ω–µ—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–µ–Ω—å—à–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ</li>
                    <li>‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–≤–µ–¥–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</li>
                `;
                updateVisualization(initialSize, initialSize, 0);
                return;
            }

            // –û—Å–Ω–æ–≤–Ω–æ–π —Ä–∞—Å—á–µ—Ç
            const totalAllowanceValue = initialSize - finalSize;
            const perSideValue = totalAllowanceValue / 2;
            
            // –†–∞—Å—á–µ—Ç —Å —É—á–µ—Ç–æ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
            const coefficient = allowanceCoefficients[material][process];
            const toleranceValue = toleranceValues[tolerance];
            
            const adjustedTotal = totalAllowanceValue * coefficient + toleranceValue;
            const adjustedPerSide = adjustedTotal / 2;
            
            // –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø–µ—Ä–µ—Ö–æ–¥–∞–º
            const roughPercentage = 0.7; // 70% –Ω–∞ —á–µ—Ä–Ω–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É
            const finishPercentage = 0.3; // 30% –Ω–∞ —á–∏—Å—Ç–æ–≤—É—é
            
            const roughValue = adjustedPerSide * roughPercentage;
            const finishValue = adjustedPerSide * finishPercentage;

            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateDisplay(adjustedTotal, adjustedPerSide, roughValue, finishValue);
            updateVisualization(initialSize, finalSize, adjustedPerSide);
            updateRecommendations(adjustedTotal, material, process);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function updateDisplay(total, perSide, rough, finish) {
            totalAllowance.textContent = `–û–±—â–∏–π –ø—Ä–∏–ø—É—Å–∫: ${total.toFixed(2)} –º–º`;
            perSideAllowance.textContent = `${perSide.toFixed(2)} –º–º`;
            roughAllowance.textContent = `${rough.toFixed(2)} –º–º`;
            finishAllowance.textContent = `${finish.toFixed(2)} –º–º`;

            // –ó–∞–±–∞–≤–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
            if (total < 1) {
                funnyComment.innerHTML = `–¢–æ–Ω–∫–∞—è —Ä–∞–±–æ—Ç–∞! <span class="emoji">üéØ</span> –ü–æ—á—Ç–∏ —é–≤–µ–ª–∏—Ä–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å!`;
            } else if (total < 5) {
                funnyComment.innerHTML = `–û—Ç–ª–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã! <span class="emoji">üëç</span> –°—Ç–∞–±–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞!`;
            } else if (total < 15) {
                funnyComment.innerHTML = `–°–æ–ª–∏–¥–Ω—ã–π –ø—Ä–∏–ø—É—Å–∫! <span class="emoji">üí™</span> –ï—Å—Ç—å –≥–¥–µ —Ä–∞–∑–≥—É–ª—è—Ç—å—Å—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É!`;
            } else {
                funnyComment.innerHTML = `–ú–æ—â–Ω–æ! <span class="emoji">üî•</span> –ù–∞—Å—Ç–æ—è—â–∞—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞!`;
            }
        }

        // –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ø—É—Å–∫–æ–≤
        function updateVisualization(initialSize, finalSize, allowancePerSide) {
            workpiece.innerHTML = '';
            
            const workpieceWidth = 280;
            const workpieceHeight = 150;
            
            // –†–∞–∑–º–µ—Ä—ã –≤ –º–∞—Å—à—Ç–∞–±–µ (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∑–∞–≥–æ—Ç–æ–≤–∫–∏ = 500 –º–º)
            const maxSize = 500;
            const initialScaled = (initialSize / maxSize) * workpieceWidth;
            const finalScaled = (finalSize / maxSize) * workpieceWidth;
            const allowanceScaled = (allowancePerSide / maxSize) * workpieceWidth;
            
            // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
            const centerX = workpieceWidth / 2;
            const centerY = workpieceHeight / 2;
            
            // –ò—Å—Ö–æ–¥–Ω–∞—è –∑–∞–≥–æ—Ç–æ–≤–∫–∞
            const roughLayer = document.createElement('div');
            roughLayer.className = 'material-layer rough-layer';
            roughLayer.style.width = initialScaled + 'px';
            roughLayer.style.height = '120px';
            roughLayer.title = `–ò—Å—Ö–æ–¥–Ω–∞—è –∑–∞–≥–æ—Ç–æ–≤–∫–∞: ${initialSize} –º–º`;
            
            // –ß–∏—Å—Ç–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
            const finishLayer = document.createElement('div');
            finishLayer.className = 'material-layer finish-layer';
            finishLayer.style.width = (initialScaled - allowanceScaled * 2) + 'px';
            finishLayer.style.height = '100px';
            finishLayer.title = `–ü–æ—Å–ª–µ —á–µ—Ä–Ω–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏`;
            
            // –ö–æ–Ω–µ—á–Ω–∞—è –¥–µ—Ç–∞–ª—å
            const finalPart = document.createElement('div');
            finalPart.className = 'material-layer final-part';
            finalPart.style.width = finalScaled + 'px';
            finalPart.style.height = '80px';
            finalPart.title = `–ì–æ—Ç–æ–≤–∞—è –¥–µ—Ç–∞–ª—å: ${finalSize} –º–º`;
            
            workpiece.appendChild(roughLayer);
            workpiece.appendChild(finishLayer);
            workpiece.appendChild(finalPart);
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–∑–º–µ—Ä–Ω—ã–µ –ª–∏–Ω–∏–∏
            addDimensionLine(centerX - initialScaled/2, centerY - 70, centerX + initialScaled/2, centerY - 70, initialSize + ' –º–º', 'horizontal');
            addDimensionLine(centerX - finalScaled/2, centerY + 70, centerX + finalScaled/2, centerY + 70, finalSize + ' –º–º', 'horizontal');
            
            // –õ–∏–Ω–∏—è –ø—Ä–∏–ø—É—Å–∫–∞
            if (allowancePerSide > 0) {
                const allowanceLine = document.createElement('div');
                allowanceLine.className = 'dimension-line vertical';
                allowanceLine.style.left = (centerX + finalScaled/2 + 40) + 'px';
                allowanceLine.style.top = (centerY - 40) + 'px';
                allowanceLine.style.width = '2px';
                allowanceLine.style.height = '80px';
                workpiece.appendChild(allowanceLine);
                
                const allowanceLabel = document.createElement('div');
                allowanceLabel.className = 'dimension-label';
                allowanceLabel.textContent = `–ü—Ä–∏–ø—É—Å–∫: ${(allowancePerSide * 2).toFixed(1)} –º–º`;
                allowanceLabel.style.left = (centerX + finalScaled/2 + 45) + 'px';
                allowanceLabel.style.top = (centerY) + 'px';
                workpiece.appendChild(allowanceLabel);
            }
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ–π –ª–∏–Ω–∏–∏
        function addDimensionLine(x1, y1, x2, y2, label, orientation) {
            const line = document.createElement('div');
            line.className = `dimension-line ${orientation}`;
            line.style.left = x1 + 'px';
            line.style.top = y1 + 'px';
            
            if (orientation === 'horizontal') {
                line.style.width = (x2 - x1) + 'px';
                line.style.height = '2px';
            } else {
                line.style.width = '2px';
                line.style.height = (y2 - y1) + 'px';
            }
            
            workpiece.appendChild(line);
            
            const labelEl = document.createElement('div');
            labelEl.className = 'dimension-label';
            labelEl.textContent = label;
            labelEl.style.left = (x1 + (x2 - x1)/2 - 20) + 'px';
            labelEl.style.top = (y1 - 20) + 'px';
            workpiece.appendChild(labelEl);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
        function updateRecommendations(totalAllowance, material, process) {
            const recommendations = [];
            
            if (totalAllowance < 2) {
                recommendations.push("‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–≤–µ—Ä–¥–æ—Å–ø–ª–∞–≤–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç");
                recommendations.push("‚Ä¢ –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π —Ä–µ–∂–∏–º");
                recommendations.push("‚Ä¢ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –°–û–ñ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞");
            } else if (totalAllowance > 10) {
                recommendations.push("‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ—â–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ");
                recommendations.push("‚Ä¢ –†–∞–∑–±–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤");
                recommendations.push("‚Ä¢ –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è");
            }
            
            if (material === 'aluminum') {
                recommendations.push("‚Ä¢ –°–ª–µ–¥–∏—Ç—å –∑–∞ –Ω–∞–ª–∏–ø–∞–Ω–∏–µ–º —Å—Ç—Ä—É–∂–∫–∏");
                recommendations.push("‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Å—Ç—Ä—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç");
            } else if (material === 'stainless') {
                recommendations.push("‚Ä¢ –ü—Ä–∏–º–µ–Ω—è—Ç—å –∏–∑–Ω–æ—Å–æ—Å—Ç–æ–π–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç");
                recommendations.push("‚Ä¢ –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞–∫–ª–µ–ø–∞");
            }
            
            if (process === 'grinding') {
                recommendations.push("‚Ä¢ –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∑–µ—Ä–Ω–∏—Å—Ç–æ—Å—Ç—å –∫—Ä—É–≥–∞");
                recommendations.push("‚Ä¢ –°–ª–µ–¥–∏—Ç—å –∑–∞ –ø—Ä–∞–≤–∫–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞");
            }
            
            recommendationsList.innerHTML = recommendations.map(rec => `<li>${rec}</li>`).join('');
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        initialSizeSlider.addEventListener('input', function() {
            initialSizeValue.textContent = this.value + ' –º–º';
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
            const minFinal = Math.max(40, this.value - 50);
            finalSizeSlider.min = minFinal;
            if (parseFloat(finalSizeSlider.value) > this.value - 5) {
                finalSizeSlider.value = this.value - 10;
                finalSizeValue.textContent = finalSizeSlider.value + ' –º–º';
            }
            calculateAllowances();
        });

        finalSizeSlider.addEventListener('input', function() {
            finalSizeValue.textContent = this.value + ' –º–º';
            calculateAllowances();
        });

        passesSlider.addEventListener('input', function() {
            passesValue.textContent = this.value;
            calculateAllowances();
        });

        materialSelect.addEventListener('change', calculateAllowances);
        processSelect.addEventListener('change', calculateAllowances);
        toleranceSelect.addEventListener('change', calculateAllowances);

        // –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç
        calculateAllowances();
    </script>
</body>
</html>